<!DOCTYPE html>
<html lang="ru">
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Arrows Pro Ultra</title>
    <style>
        :root {
            --c-blue: #003366;
            --c-bg: #f4f6f9;
            --c-gray: #e0e0e0;
            --c-red: #ff4d4d;
            --c-green: #2ecc71;
            --c-gold: #FFD700;
            --c-purple: #9b59b6;
            --c-orange: #e67e22;
            --c-text: #333333;
            --c-text-light: #666666;
        }
        
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: var(--c-bg);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            overflow: hidden;
            height: 100vh;
            color: var(--c-text);
        }
        
        #app {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            flex-direction: column;
            max-width: 500px;
            margin: 0 auto;
            background: var(--c-bg);
        }
        
        /* Language Switcher */
        .lang-switcher {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 2000;
            display: flex;
            gap: 5px;
            background: rgba(255, 255, 255, 0.95);
            padding: 8px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 51, 102, 0.1);
        }
        
        .lang-btn {
            width: 45px;
            height: 35px;
            border: 2px solid var(--c-blue);
            border-radius: 8px;
            background: white;
            color: var(--c-blue);
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .lang-btn.active {
            background: var(--c-blue);
            color: white;
            transform: scale(1.05);
        }
        
        .lang-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 3px 10px rgba(0, 51, 102, 0.2);
        }
        
        /* Screens */
        .screen {
            position: absolute;
            inset: 0;
            display: none;
            flex-direction: column;
            background: var(--c-bg);
            z-index: 10;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .screen.active {
            display: flex;
        }
        
        /* Top Bar */
        .top-ui {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 70px;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }
        
        .top-left-group {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .stat-pill {
            background: white;
            padding: 8px 15px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid #eee;
            min-width: 80px;
        }
        
        .stat-pill .icon {
            color: var(--c-blue);
        }
        
        .stat-pill.coins .icon {
            color: var(--c-gold);
        }
        
        .stat-value {
            font-weight: 800;
            font-size: 16px;
        }
        
        /* Home Screen */
        #scr-home {
            align-items: center;
            justify-content: center;
            padding: 20px;
            text-align: center;
        }
        
        .logo {
            font-size: 4rem;
            font-weight: 900;
            color: var(--c-blue);
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .level-indicator {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--c-blue);
            opacity: 0.8;
            margin-bottom: 20px;
        }
        
        .play-btn {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--c-blue), #0066cc);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 15px 30px rgba(0, 51, 102, 0.3);
            cursor: pointer;
            margin: 20px auto;
            transition: all 0.3s;
        }
        
        .play-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 40px rgba(0, 51, 102, 0.4);
        }
        
        .play-btn:active {
            transform: scale(0.95);
        }
        
        .play-icon {
            width: 40px;
            height: 40px;
            fill: white;
        }
        
        .game-info {
            max-width: 300px;
            text-align: center;
            margin: 20px auto;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .game-info-title {
            font-weight: bold;
            color: var(--c-blue);
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .game-info-desc {
            color: var(--c-text-light);
            font-size: 14px;
            line-height: 1.4;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .action-btn {
            padding: 12px 25px;
            border-radius: 12px;
            border: none;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 120px;
        }
        
        .btn-primary {
            background: var(--c-blue);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 51, 102, 0.2);
        }
        
        .btn-secondary {
            background: var(--c-gold);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
        }
        
        .btn-tertiary {
            background: var(--c-purple);
            color: white;
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.2);
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }
        
        .action-btn:active {
            transform: translateY(1px);
        }
        
        /* Game Screen */
        #scr-game {
            padding: 10px;
        }
        
        .board-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            width: 100%;
        }
        
        #board {
            background: white;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
            transition: all 0.3s;
        }
        
        /* Victory Screen */
        #scr-win {
            align-items: center;
            justify-content: center;
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1500;
        }
        
        .win-content {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px;
            background: white;
            border-radius: 25px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            max-width: 90%;
        }
        
        .win-title {
            font-size: 3.5rem;
            font-weight: 900;
            color: var(--c-blue);
            margin-bottom: 20px;
            animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .coins-earned {
            font-size: 1.8rem;
            color: var(--c-gold);
            margin: 15px 0;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .win-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .win-btn {
            padding: 15px 30px;
            border-radius: 15px;
            border: none;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            min-width: 140px;
            transition: all 0.3s;
        }
        
        .win-btn-menu {
            background: var(--c-gray);
            color: #555;
        }
        
        .win-btn-next {
            background: var(--c-blue);
            color: white;
            box-shadow: 0 8px 20px rgba(0, 51, 102, 0.25);
        }
        
        /* Statistics Screen */
        #scr-stats {
            padding: 20px;
            overflow-y: auto;
        }
        
        .stats-header {
            color: var(--c-blue);
            margin-bottom: 25px;
            font-size: 2rem;
            text-align: center;
        }
        
        .stats-card {
            background: white;
            margin: 15px 0;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            color: var(--c-text-light);
            font-size: 16px;
        }
        
        .stat-value {
            font-weight: bold;
            color: var(--c-blue);
            font-size: 18px;
        }
        
        .leaderboard-section {
            margin-top: 30px;
        }
        
        .leaderboard-title {
            color: var(--c-blue);
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .leaderboard-list {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .leader-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
        }
        
        .leader-row:last-child {
            border-bottom: none;
        }
        
        .leader-row.you {
            background: rgba(0, 51, 102, 0.05);
        }
        
        .leader-rank {
            width: 40px;
            text-align: center;
            font-weight: bold;
            color: var(--c-blue);
            font-size: 18px;
        }
        
        .leader-name {
            flex: 1;
            margin: 0 20px;
            font-weight: bold;
            font-size: 16px;
        }
        
        .leader-score {
            font-weight: bold;
            color: var(--c-gold);
            font-size: 16px;
        }
        
        /* Shop Screen */
        #scr-shop {
            padding: 20px;
            overflow-y: auto;
        }
        
        .shop-header {
            color: var(--c-blue);
            margin-bottom: 25px;
            font-size: 2rem;
            text-align: center;
        }
        
        .shop-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .shop-item {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .shop-item-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .shop-item-name {
            font-weight: bold;
            color: var(--c-blue);
            margin-bottom: 5px;
        }
        
        .shop-item-price {
            color: var(--c-gold);
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .shop-item-btn {
            padding: 8px 15px;
            background: var(--c-blue);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
        }
        
        .shop-item-btn:disabled {
            background: var(--c-gray);
            cursor: not-allowed;
        }
        
        .shop-item-btn:hover:not(:disabled) {
            background: #002244;
        }
        
        /* Settings Screen */
        #scr-set {
            padding: 20px;
            overflow-y: auto;
        }
        
        .settings-header {
            color: var(--c-blue);
            margin-bottom: 25px;
            font-size: 2rem;
            text-align: center;
        }
        
        .setting-item {
            background: white;
            margin: 10px 0;
            padding: 20px;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .setting-label {
            font-weight: 500;
            color: var(--c-text);
            font-size: 16px;
        }
        
        .toggle-switch {
            width: 60px;
            height: 30px;
            background: var(--c-gray);
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .toggle-switch.active {
            background: var(--c-blue);
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .toggle-switch.active::after {
            left: 33px;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .lang-option {
            padding: 10px 20px;
            border: 2px solid var(--c-blue);
            border-radius: 10px;
            background: none;
            color: var(--c-blue);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .lang-option.active {
            background: var(--c-blue);
            color: white;
        }
        
        .lang-option:hover {
            transform: scale(1.05);
        }
        
        /* Navigation */
        .nav-bar {
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 500px;
            height: 70px;
            background: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.1);
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0.5;
            color: var(--c-blue);
            cursor: pointer;
            transition: all 0.3s;
            padding: 10px;
            flex: 1;
        }
        
        .nav-item.active {
            opacity: 1;
            color: var(--c-blue);
        }
        
        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }
        
        .nav-label {
            font-size: 12px;
            font-weight: 500;
        }
        
        /* Loading */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--c-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Confetti */
        #confetti-canvas {
            position: absolute;
            inset: 0;
            pointer-events: none;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        /* Responsive */
        @media (max-width: 480px) {
            .logo {
                font-size: 3rem;
            }
            
            .play-btn {
                width: 100px;
                height: 100px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .action-btn {
                width: 100%;
                max-width: 250px;
            }
            
            .stat-pill {
                padding: 6px 12px;
                font-size: 14px;
            }
            
            .shop-items {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .nav-bar {
                height: 60px;
            }
            
            .nav-icon {
                font-size: 20px;
            }
            
            .nav-label {
                font-size: 10px;
            }
            
            .lang-switcher {
                top: 5px;
                right: 5px;
                padding: 6px;
            }
            
            .lang-btn {
                width: 40px;
                height: 30px;
                font-size: 12px;
            }
        }
        
        @media (max-width: 350px) {
            .logo {
                font-size: 2.5rem;
            }
            
            .top-ui {
                padding: 10px 15px;
            }
            
            .stat-pill {
                min-width: 70px;
                padding: 5px 10px;
            }
            
            .shop-items {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Language Switcher -->
        <div class="lang-switcher" id="lang-switcher">
            <button class="lang-btn active" data-lang="ru" title="–†—É—Å—Å–∫–∏–π">RU</button>
            <button class="lang-btn" data-lang="en" title="English">EN</button>
            <button class="lang-btn" data-lang="zh" title="‰∏≠Êñá">ZH</button>
        </div>
        
        <!-- Home Screen -->
        <div id="scr-home" class="screen active">
            <div class="logo">Arrows</div>
            <div class="level-indicator" id="level-indicator">LEVEL 1</div>
            
            <div class="game-info">
                <div class="game-info-title" id="game-goal-title">üéØ –¶–µ–ª—å –∏–≥—Ä—ã:</div>
                <div class="game-info-desc" id="game-goal-desc">–û—á–∏—Å—Ç–∏ –ø–æ–ª–µ –æ—Ç –≤—Å–µ—Ö —Å—Ç—Ä–µ–ª–æ–∫, –Ω–∞–∂–∏–º–∞—è –Ω–∞ –Ω–∏—Ö –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ!</div>
            </div>
            
            <div class="play-btn" id="play-button">
                <svg class="play-icon" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn btn-primary" id="btn-stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                <button class="action-btn btn-secondary" id="btn-shop">–ú–∞–≥–∞–∑–∏–Ω</button>
                <button class="action-btn btn-tertiary" id="btn-settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
        </div>
        
        <!-- Game Screen -->
        <div id="scr-game" class="screen">
            <div class="board-container">
                <div id="board"></div>
            </div>
        </div>
        
        <!-- Victory Screen -->
        <div id="scr-win" class="screen">
            <canvas id="confetti-canvas"></canvas>
            <div class="win-content">
                <div class="win-title" id="win-title">–ü–æ–±–µ–¥–∞!</div>
                <div class="coins-earned" id="coins-earned">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.31-8.86c-1.77-.45-2.34-.94-2.34-1.67 0-.84.79-1.43 2.1-1.43 1.38 0 1.9.66 1.94 1.64h1.71c-.05-1.34-.87-2.57-2.49-2.97V5H10.9v1.69c-1.51.32-2.72 1.3-2.72 2.81 0 1.79 1.49 2.69 3.66 3.21 1.95.46 2.34 1.15 2.34 1.87 0 .53-.39 1.39-2.1 1.39-1.6 0-2.23-.72-2.32-1.64H8.04c.1 1.7 1.36 2.66 2.86 2.97V19h2.34v-1.67c1.52-.29 2.72-1.16 2.73-2.77-.01-2.2-1.9-2.96-3.66-3.42z"/>
                    </svg>
                    <span id="coins-amount">+20</span>
                </div>
                <div class="win-buttons">
                    <button class="win-btn win-btn-menu" id="btn-menu">–ú–µ–Ω—é</button>
                    <button class="win-btn win-btn-next" id="btn-next">–°–ª–µ–¥—É—é—â–∏–π</button>
                </div>
            </div>
        </div>
        
        <!-- Statistics Screen -->
        <div id="scr-stats" class="screen">
            <h2 class="stats-header" id="stats-header">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stats-card">
                <div class="stat-item">
                    <span class="stat-label" id="stat-levels">–ü—Ä–æ–π–¥–µ–Ω–æ —É—Ä–æ–≤–Ω–µ–π:</span>
                    <span class="stat-value" id="stat-levels-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="stat-coins">–í—Å–µ–≥–æ –º–æ–Ω–µ—Ç:</span>
                    <span class="stat-value" id="stat-coins-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="stat-rank">–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞–Ω–≥:</span>
                    <span class="stat-value" id="stat-rank-value">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="stat-games">–°—ã–≥—Ä–∞–Ω–æ –∏–≥—Ä:</span>
                    <span class="stat-value" id="stat-games-value">0</span>
                </div>
            </div>
            
            <div class="leaderboard-section">
                <h3 class="leaderboard-title" id="leaderboard-title">–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h3>
                <div class="leaderboard-list" id="leaderboard-list">
                    <!-- Leaderboard will be populated dynamically -->
                </div>
            </div>
        </div>
        
        <!-- Shop Screen -->
        <div id="scr-shop" class="screen">
            <h2 class="shop-header" id="shop-header">–ú–∞–≥–∞–∑–∏–Ω</h2>
            <div class="shop-items">
                <div class="shop-item">
                    <div class="shop-item-icon">üéØ</div>
                    <div class="shop-item-name" id="skin-classic">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–∫–∏–Ω</div>
                    <div class="shop-item-price">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
                    <button class="shop-item-btn" id="btn-buy-classic" disabled>–í—ã–±—Ä–∞–Ω–æ</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-icon">üî•</div>
                    <div class="shop-item-name" id="skin-fire">–û–≥–Ω–µ–Ω–Ω—ã–π —Å–∫–∏–Ω</div>
                    <div class="shop-item-price">100 –º–æ–Ω–µ—Ç</div>
                    <button class="shop-item-btn" id="btn-buy-fire">–ö—É–ø–∏—Ç—å</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-icon">‚ùÑÔ∏è</div>
                    <div class="shop-item-name" id="skin-ice">–õ–µ–¥—è–Ω–æ–π —Å–∫–∏–Ω</div>
                    <div class="shop-item-price">150 –º–æ–Ω–µ—Ç</div>
                    <button class="shop-item-btn" id="btn-buy-ice">–ö—É–ø–∏—Ç—å</button>
                </div>
            </div>
        </div>
        
        <!-- Settings Screen -->
        <div id="scr-set" class="screen">
            <h2 class="settings-header" id="settings-header">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            
            <div class="setting-item">
                <span class="setting-label" id="setting-sound">–ó–≤—É–∫</span>
                <div class="toggle-switch active" id="toggle-sound"></div>
            </div>
            
            <div class="setting-item">
                <span class="setting-label" id="setting-vibration">–í–∏–±—Ä–∞—Ü–∏—è</span>
                <div class="toggle-switch active" id="toggle-vibration"></div>
            </div>
            
            <div class="setting-item">
                <div>
                    <span class="setting-label" id="setting-language">–Ø–∑—ã–∫</span>
                    <div class="language-buttons">
                        <button class="lang-option active" data-lang="ru">–†—É—Å—Å–∫–∏–π</button>
                        <button class="lang-option" data-lang="en">English</button>
                        <button class="lang-option" data-lang="zh">‰∏≠Êñá</button>
                    </div>
                </div>
            </div>
            
            <div class="setting-item">
                <span class="setting-label" id="setting-about">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</span>
                <span class="stat-value">Arrows Pro v1.0</span>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="nav-bar">
            <div class="nav-item active" data-screen="home">
                <div class="nav-icon">üè†</div>
                <div class="nav-label" id="nav-home">–ì–ª–∞–≤–Ω–∞—è</div>
            </div>
            <div class="nav-item" data-screen="stats">
                <div class="nav-icon">üìä</div>
                <div class="nav-label" id="nav-stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
            </div>
            <div class="nav-item" data-screen="shop">
                <div class="nav-icon">üõí</div>
                <div class="nav-label" id="nav-shop">–ú–∞–≥–∞–∑–∏–Ω</div>
            </div>
            <div class="nav-item" data-screen="set">
                <div class="nav-icon">‚öôÔ∏è</div>
                <div class="nav-label" id="nav-settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            </div>
        </div>
        
        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loading-overlay">
            <div class="loading-spinner"></div>
        </div>
    </div>

    <script>
        // –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –¥–ª—è –∏–≥—Ä—ã
        const GAME_TEXTS = {
            ru: {
                // –û–±—â–∏–µ
                appTitle: "Arrows Pro",
                loading: "–ó–∞–≥—Ä—É–∑–∫–∞...",
                
                // –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
                level: "–£–†–û–í–ï–ù–¨",
                goalTitle: "üéØ –¶–µ–ª—å –∏–≥—Ä—ã:",
                goalDesc: "–û—á–∏—Å—Ç–∏ –ø–æ–ª–µ –æ—Ç –≤—Å–µ—Ö —Å—Ç—Ä–µ–ª–æ–∫, –Ω–∞–∂–∏–º–∞—è –Ω–∞ –Ω–∏—Ö –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ!",
                playButton: "–ò–≥—Ä–∞—Ç—å",
                statsButton: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                shopButton: "–ú–∞–≥–∞–∑–∏–Ω",
                settingsButton: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                statsHeader: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                statLevels: "–ü—Ä–æ–π–¥–µ–Ω–æ —É—Ä–æ–≤–Ω–µ–π:",
                statCoins: "–í—Å–µ–≥–æ –º–æ–Ω–µ—Ç:",
                statRank: "–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞–Ω–≥:",
                statGames: "–°—ã–≥—Ä–∞–Ω–æ –∏–≥—Ä:",
                leaderboardTitle: "–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤",
                rankNotAvailable: "–ù–µ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ",
                you: "(–í—ã)",
                
                // –ú–∞–≥–∞–∑–∏–Ω
                shopHeader: "–ú–∞–≥–∞–∑–∏–Ω",
                skinClassic: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–∫–∏–Ω",
                skinFire: "–û–≥–Ω–µ–Ω–Ω—ã–π —Å–∫–∏–Ω",
                skinIce: "–õ–µ–¥—è–Ω–æ–π —Å–∫–∏–Ω",
                free: "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ",
                coins: "–º–æ–Ω–µ—Ç",
                buyButton: "–ö—É–ø–∏—Ç—å",
                selectedButton: "–í—ã–±—Ä–∞–Ω–æ",
                notEnoughCoins: "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç",
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                settingsHeader: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
                settingSound: "–ó–≤—É–∫",
                settingVibration: "–í–∏–±—Ä–∞—Ü–∏—è",
                settingLanguage: "–Ø–∑—ã–∫",
                settingAbout: "–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏",
                
                // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                navHome: "–ì–ª–∞–≤–Ω–∞—è",
                navStats: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                navShop: "–ú–∞–≥–∞–∑–∏–Ω",
                navSettings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
                
                // –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
                victory: "–ü–æ–±–µ–¥–∞!",
                menuButton: "–ú–µ–Ω—é",
                nextButton: "–°–ª–µ–¥—É—é—â–∏–π",
                excellent: "–û—Ç–ª–∏—á–Ω–æ!",
                amazing: "–°—É–ø–µ—Ä!",
                genius: "–ì–µ–Ω–∏–∞–ª—å–Ω–æ!",
                fantastic: "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞!",
                
                // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                purchaseSuccess: "–ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞!",
                skinSelected: "–°–∫–∏–Ω –≤—ã–±—Ä–∞–Ω!",
                errorLoading: "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",
                tryAgain: "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞"
            },
            
            en: {
                // Common
                appTitle: "Arrows Pro",
                loading: "Loading...",
                
                // Home screen
                level: "LEVEL",
                goalTitle: "üéØ Game Goal:",
                goalDesc: "Clear the field of all arrows by clicking them in the correct order!",
                playButton: "Play",
                statsButton: "Statistics",
                shopButton: "Shop",
                settingsButton: "Settings",
                
                // Statistics
                statsHeader: "Statistics",
                statLevels: "Levels Passed:",
                statCoins: "Total Coins:",
                statRank: "Global Rank:",
                statGames: "Games Played:",
                leaderboardTitle: "Leaderboard",
                rankNotAvailable: "Not ranked",
                you: "(You)",
                
                // Shop
                shopHeader: "Shop",
                skinClassic: "Classic Skin",
                skinFire: "Fire Skin",
                skinIce: "Ice Skin",
                free: "Free",
                coins: "coins",
                buyButton: "Buy",
                selectedButton: "Selected",
                notEnoughCoins: "Not enough coins",
                
                // Settings
                settingsHeader: "Settings",
                settingSound: "Sound",
                settingVibration: "Vibration",
                settingLanguage: "Language",
                settingAbout: "About",
                
                // Navigation
                navHome: "Home",
                navStats: "Stats",
                navShop: "Shop",
                navSettings: "Settings",
                
                // Victory screen
                victory: "Victory!",
                menuButton: "Menu",
                nextButton: "Next",
                excellent: "Excellent!",
                amazing: "Amazing!",
                genius: "Genius!",
                fantastic: "Fantastic!",
                
                // Notifications
                purchaseSuccess: "Purchase successful!",
                skinSelected: "Skin selected!",
                errorLoading: "Error loading",
                tryAgain: "Try again"
            },
            
            zh: {
                // ÈÄöÁî®
                appTitle: "Arrows Pro",
                loading: "Âä†ËΩΩ‰∏≠...",
                
                // ‰∏ªÂ±èÂπï
                level: "ÂÖ≥Âç°",
                goalTitle: "üéØ Ê∏∏ÊàèÁõÆÊ†á:",
                goalDesc: "ÈÄöËøáÊåâÊ≠£Á°ÆÈ°∫Â∫èÁÇπÂáªÊâÄÊúâÁÆ≠Â§¥Êù•Ê∏ÖÈô§Âú∫Âú∞ÔºÅ",
                playButton: "Ê∏∏Êàè",
                statsButton: "ÁªüËÆ°",
                shopButton: "ÂïÜÂ∫ó",
                settingsButton: "ËÆæÁΩÆ",
                
                // ÁªüËÆ°
                statsHeader: "ÁªüËÆ°",
                statLevels: "ÈÄöËøáÁ≠âÁ∫ß:",
                statCoins: "ÊÄªÈáëÂ∏Å:",
                statRank: "ÂÖ®ÁêÉÊéíÂêç:",
                statGames: "Ê∏∏ÊàèÊ¨°Êï∞:",
                leaderboardTitle: "ÊéíË°åÊ¶ú",
                rankNotAvailable: "Êú™ÊéíÂêç",
                you: "(ÊÇ®)",
                
                // ÂïÜÂ∫ó
                shopHeader: "ÂïÜÂ∫ó",
                skinClassic: "ÁªèÂÖ∏ÁöÆËÇ§",
                skinFire: "ÁÅ´ÁÑ∞ÁöÆËÇ§",
                skinIce: "ÂÜ∞ÈúúÁöÆËÇ§",
                free: "ÂÖçË¥π",
                coins: "ÈáëÂ∏Å",
                buyButton: "Ë¥≠‰π∞",
                selectedButton: "Â∑≤ÈÄâÊã©",
                notEnoughCoins: "ÈáëÂ∏Å‰∏çË∂≥",
                
                // ËÆæÁΩÆ
                settingsHeader: "ËÆæÁΩÆ",
                settingSound: "Â£∞Èü≥",
                settingVibration: "ÊåØÂä®",
                settingLanguage: "ËØ≠Ë®Ä",
                settingAbout: "ÂÖ≥‰∫é",
                
                // ÂØºËà™
                navHome: "‰∏ªÈ°µ",
                navStats: "ÁªüËÆ°",
                navShop: "ÂïÜÂ∫ó",
                navSettings: "ËÆæÁΩÆ",
                
                // ËÉúÂà©Â±èÂπï
                victory: "ËÉúÂà©ÔºÅ",
                menuButton: "ËèúÂçï",
                nextButton: "‰∏ã‰∏Ä‰∏™",
                excellent: "Â§™Ê£í‰∫ÜÔºÅ",
                amazing: "ÊÉä‰∫∫ÔºÅ",
                genius: "Â§©ÊâçÔºÅ",
                fantastic: "Á≤æÂΩ©ÔºÅ",
                
                // ÈÄöÁü•
                purchaseSuccess: "Ë¥≠‰π∞ÊàêÂäüÔºÅ",
                skinSelected: "ÁöÆËÇ§Â∑≤ÈÄâÊã©ÔºÅ",
                errorLoading: "Âä†ËΩΩÈîôËØØ",
                tryAgain: "ÂÜçËØï‰∏ÄÊ¨°"
            }
        };

        class GameApp {
            constructor() {
                this.currentLang = 'ru';
                this.currentScreen = 'home';
                this.isLoading = false;
                this.state = {
                    level: 1,
                    coins: 0,
                    gamesPlayed: 0,
                    rank: -1,
                    sound: true,
                    vibration: true
                };
                
                this.init();
            }
            
            init() {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —è–∑—ã–∫
                this.loadLanguage();
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–±—ã—Ç–∏–π
                this.setupEvents();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                this.updateUI();
                
                // –°–∫—Ä—ã–≤–∞–µ–º loading
                setTimeout(() => {
                    this.hideLoading();
                }, 1000);
            }
            
            loadLanguage() {
                const savedLang = localStorage.getItem('game_language');
                if (savedLang && GAME_TEXTS[savedLang]) {
                    this.currentLang = savedLang;
                } else {
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    const browserLang = navigator.language.toLowerCase();
                    if (browserLang.includes('zh')) {
                        this.currentLang = 'zh';
                    } else if (browserLang.includes('en')) {
                        this.currentLang = 'en';
                    } else {
                        this.currentLang = 'ru';
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —è–∑—ã–∫–æ–≤
                this.updateLanguageButtons();
            }
            
            saveLanguage(lang) {
                this.currentLang = lang;
                localStorage.setItem('game_language', lang);
                this.updateLanguageButtons();
                this.updateUI();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —è–∑—ã–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                this.saveLanguageToServer(lang);
            }
            
            async saveLanguageToServer(lang) {
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ API –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —è–∑—ã–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
                try {
                    const tg = window.Telegram?.WebApp;
                    if (tg && tg.initDataUnsafe?.user) {
                        const response = await fetch('https://malollas.pythonanywhere.com/api/set_language', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                user_id: tg.initDataUnsafe.user.id,
                                language: lang
                            })
                        });
                        
                        if (!response.ok) {
                            console.error('Failed to save language to server');
                        }
                    }
                } catch (error) {
                    console.error('Error saving language:', error);
                }
            }
            
            updateLanguageButtons() {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤ —è–∑—ã–∫–æ–≤–æ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.lang === this.currentLang) {
                        btn.classList.add('active');
                    }
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
                document.querySelectorAll('.lang-option').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.lang === this.currentLang) {
                        btn.classList.add('active');
                    }
                });
            }
            
            setupEvents() {
                // –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const lang = btn.dataset.lang;
                        this.saveLanguage(lang);
                    });
                });
                
                // –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
                document.querySelectorAll('.lang-option').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const lang = btn.dataset.lang;
                        this.saveLanguage(lang);
                    });
                });
                
                // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const screen = item.dataset.screen;
                        this.showScreen(screen);
                    });
                });
                
                // –ö–Ω–æ–ø–∫–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
                document.getElementById('play-button').addEventListener('click', () => {
                    this.showScreen('game');
                    // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
                    setTimeout(() => {
                        this.showVictory(20);
                    }, 2000);
                });
                
                document.getElementById('btn-stats').addEventListener('click', () => {
                    this.showScreen('stats');
                });
                
                document.getElementById('btn-shop').addEventListener('click', () => {
                    this.showScreen('shop');
                });
                
                document.getElementById('btn-settings').addEventListener('click', () => {
                    this.showScreen('set');
                });
                
                // –ö–Ω–æ–ø–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–±–µ–¥—ã
                document.getElementById('btn-menu').addEventListener('click', () => {
                    this.showScreen('home');
                });
                
                document.getElementById('btn-next').addEventListener('click', () => {
                    // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é
                    this.state.level++;
                    this.showScreen('home');
                    this.updateUI();
                });
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
                document.getElementById('toggle-sound').addEventListener('click', () => {
                    const toggle = document.getElementById('toggle-sound');
                    toggle.classList.toggle('active');
                    this.state.sound = toggle.classList.contains('active');
                });
                
                document.getElementById('toggle-vibration').addEventListener('click', () => {
                    const toggle = document.getElementById('toggle-vibration');
                    toggle.classList.toggle('active');
                    this.state.vibration = toggle.classList.contains('active');
                });
                
                // –ö–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
                document.getElementById('btn-buy-fire').addEventListener('click', () => {
                    this.buySkin('fire', 100);
                });
                
                document.getElementById('btn-buy-ice').addEventListener('click', () => {
                    this.buySkin('ice', 150);
                });
            }
            
            showScreen(screenName) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
                this.currentScreen = screenName;
                
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
                const targetScreen = document.getElementById(`scr-${screenName}`);
                if (targetScreen) {
                    targetScreen.classList.add('active');
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.dataset.screen === screenName) {
                        item.classList.add('active');
                    }
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –Ω–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
                this.updateUI();
            }
            
            updateUI() {
                const texts = GAME_TEXTS[this.currentLang];
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                document.title = texts.appTitle;
                
                // –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
                document.getElementById('level-indicator').textContent = `${texts.level} ${this.state.level}`;
                document.getElementById('game-goal-title').textContent = texts.goalTitle;
                document.getElementById('game-goal-desc').textContent = texts.goalDesc;
                document.getElementById('btn-stats').textContent = texts.statsButton;
                document.getElementById('btn-shop').textContent = texts.shopButton;
                document.getElementById('btn-settings').textContent = texts.settingsButton;
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                document.getElementById('stats-header').textContent = texts.statsHeader;
                document.getElementById('stat-levels').textContent = texts.statLevels;
                document.getElementById('stat-coins').textContent = texts.statCoins;
                document.getElementById('stat-rank').textContent = texts.statRank;
                document.getElementById('stat-games').textContent = texts.statGames;
                document.getElementById('leaderboard-title').textContent = texts.leaderboardTitle;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                document.getElementById('stat-levels-value').textContent = this.state.level - 1;
                document.getElementById('stat-coins-value').textContent = this.state.coins;
                document.getElementById('stat-games-value').textContent = this.state.gamesPlayed;
                document.getElementById('stat-rank-value').textContent = 
                    this.state.rank > 0 ? `#${this.state.rank}` : texts.rankNotAvailable;
                
                // –ú–∞–≥–∞–∑–∏–Ω
                document.getElementById('shop-header').textContent = texts.shopHeader;
                document.getElementById('skin-classic').textContent = texts.skinClassic;
                document.getElementById('skin-fire').textContent = texts.skinFire;
                document.getElementById('skin-ice').textContent = texts.skinIce;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏
                const buyFireBtn = document.getElementById('btn-buy-fire');
                const buyIceBtn = document.getElementById('btn-buy-ice');
                
                if (this.state.coins >= 100) {
                    buyFireBtn.textContent = texts.buyButton;
                    buyFireBtn.disabled = false;
                } else {
                    buyFireBtn.textContent = texts.notEnoughCoins;
                    buyFireBtn.disabled = true;
                }
                
                if (this.state.coins >= 150) {
                    buyIceBtn.textContent = texts.buyButton;
                    buyIceBtn.disabled = false;
                } else {
                    buyIceBtn.textContent = texts.notEnoughCoins;
                    buyIceBtn.disabled = true;
                }
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                document.getElementById('settings-header').textContent = texts.settingsHeader;
                document.getElementById('setting-sound').textContent = texts.settingSound;
                document.getElementById('setting-vibration').textContent = texts.settingVibration;
                document.getElementById('setting-language').textContent = texts.settingLanguage;
                document.getElementById('setting-about').textContent = texts.settingAbout;
                
                // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                document.getElementById('nav-home').textContent = texts.navHome;
                document.getElementById('nav-stats').textContent = texts.navStats;
                document.getElementById('nav-shop').textContent = texts.navShop;
                document.getElementById('nav-settings').textContent = texts.navSettings;
                
                // –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
                document.getElementById('win-title').textContent = texts.victory;
                document.getElementById('btn-menu').textContent = texts.menuButton;
                document.getElementById('btn-next').textContent = texts.nextButton;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤–∞–ª—é—Ç—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ
                const priceElements = document.querySelectorAll('.shop-item-price');
                priceElements[0].textContent = texts.free;
                priceElements[1].textContent = `100 ${texts.coins}`;
                priceElements[2].textContent = `150 ${texts.coins}`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤ –≤–µ—Ä—Ö–Ω–µ–º —è–∑—ã–∫–æ–≤–æ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ
                document.querySelectorAll('.lang-btn').forEach((btn, index) => {
                    const lang = btn.dataset.lang;
                    if (lang === 'ru') btn.title = "–†—É—Å—Å–∫–∏–π";
                    if (lang === 'en') btn.title = "English";
                    if (lang === 'zh') btn.title = "‰∏≠Êñá";
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
                const soundToggle = document.getElementById('toggle-sound');
                const vibrationToggle = document.getElementById('toggle-vibration');
                
                if (this.state.sound) {
                    soundToggle.classList.add('active');
                } else {
                    soundToggle.classList.remove('active');
                }
                
                if (this.state.vibration) {
                    vibrationToggle.classList.add('active');
                } else {
                    vibrationToggle.classList.remove('active');
                }
            }
            
            showLoading() {
                this.isLoading = true;
                document.getElementById('loading-overlay').style.display = 'flex';
            }
            
            hideLoading() {
                this.isLoading = false;
                document.getElementById('loading-overlay').style.display = 'none';
            }
            
            buySkin(skinName, price) {
                const texts = GAME_TEXTS[this.currentLang];
                
                if (this.state.coins >= price) {
                    this.state.coins -= price;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
                    document.querySelectorAll('.shop-item-btn').forEach(btn => {
                        btn.textContent = texts.buyButton;
                        btn.disabled = false;
                    });
                    
                    const buyButton = document.getElementById(`btn-buy-${skinName}`);
                    buyButton.textContent = texts.selectedButton;
                    buyButton.disabled = true;
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    alert(texts.purchaseSuccess);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º UI
                    this.updateUI();
                } else {
                    alert(texts.notEnoughCoins);
                }
            }
            
            // –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–∫–∞–∑–∞ —ç–∫—Ä–∞–Ω–∞ –ø–æ–±–µ–¥—ã
            showVictory(coinsEarned) {
                this.state.coins += coinsEarned;
                this.state.level++;
                this.state.gamesPlayed++;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–±–µ–¥—ã
                document.getElementById('coins-amount').textContent = `+${coinsEarned}`;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
                this.showScreen('win');
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
                this.startConfetti();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                this.updateUI();
            }
            
            startConfetti() {
                const canvas = document.getElementById('confetti-canvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                
                const confettiPieces = [];
                const colors = ['#ff4d4d', '#2ecc71', '#3498db', '#f1c40f', '#9b59b6'];
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
                for (let i = 0; i < 150; i++) {
                    confettiPieces.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height - canvas.height,
                        r: Math.random() * 10 + 5,
                        d: Math.random() * 5 + 2,
                        color: colors[Math.floor(Math.random() * colors.length)],
                        tilt: Math.random() * 10 - 10,
                        tiltAngleIncrement: Math.random() * 0.07 + 0.05,
                        tiltAngle: 0
                    });
                }
                
                const drawConfetti = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    confettiPieces.forEach((p, i) => {
                        ctx.beginPath();
                        ctx.lineWidth = p.d;
                        ctx.strokeStyle = p.color;
                        ctx.moveTo(p.x + p.tilt + p.r, p.y);
                        ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r);
                        ctx.stroke();
                        
                        p.tiltAngle += p.tiltAngleIncrement;
                        p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2;
                        p.tilt = Math.sin(p.tiltAngle) * 15;
                        
                        if (p.y > canvas.height) {
                            confettiPieces[i] = {
                                x: Math.random() * canvas.width,
                                y: -10,
                                r: p.r,
                                d: p.d,
                                color: p.color,
                                tilt: p.tilt,
                                tiltAngleIncrement: p.tiltAngleIncrement,
                                tiltAngle: p.tiltAngle
                            };
                        }
                    });
                    
                    requestAnimationFrame(drawConfetti);
                };
                
                drawConfetti();
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    // –û—á–∏—â–∞–µ–º canvas
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }, 5000);
            }
            
            // –ú–µ—Ç–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
            async loadLeaderboard() {
                try {
                    const response = await fetch('https://malollas.pythonanywhere.com/api/leaderboard');
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            this.renderLeaderboard(data.leaderboard);
                        }
                    }
                } catch (error) {
                    console.error('Error loading leaderboard:', error);
                }
            }
            
            renderLeaderboard(players) {
                const container = document.getElementById('leaderboard-list');
                const texts = GAME_TEXTS[this.currentLang];
                
                if (!players || players.length === 0) {
                    container.innerHTML = `<div style="padding: 20px; text-align: center; color: #666;">${texts.rankNotAvailable}</div>`;
                    return;
                }
                
                let html = '';
                players.slice(0, 10).forEach((player, index) => {
                    const rank = index + 1;
                    const rankIcon = rank === 1 ? 'üëë' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : `${rank}.`;
                    
                    html += `
                        <div class="leader-row">
                            <div class="leader-rank">${rankIcon}</div>
                            <div class="leader-name">
                                ${player.username || `Player ${player.user_id}`}
                            </div>
                            <div class="leader-score">${player.score} LVL</div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', () => {
            window.gameApp = new GameApp();
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('confetti-canvas');
            if (canvas) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
        });
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('game_state', JSON.stringify(window.gameApp.state));
        });
    </script>
</body>
</html>
